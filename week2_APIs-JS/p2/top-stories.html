<!DOCTYPE html>
<html lang="en-US">
<head>
	<title>What to read today</title>

	<meta charset="utf-8">

	<!-- Force latest available IE rendering engine and Chrome Frame (if installed) -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<!-- Mobile Screen Resizing -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<style type="text/css">
		/**
		 * Add box sizing to everything
		 * @link http://www.paulirish.com/2012/box-sizing-border-box-ftw/
		 */
		/* line 38, src/sass/components/_normalize.scss */
		*,
		*:before,
		*:after {
			box-sizing: border-box;
		}

		/**
		 * Layout
		 */
		body {
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
			font-size: 112.5%;
			margin-left: auto;
			margin-right: auto;
			max-width: 40em;
			width: 88%;
		}

		p {
			font-size: .9em;
			color: grey;
		}
	</style>

</head>
<body>

	<h1>What to read today</h1>
	<div id="app"></div>

<script src="helper.js"></script>
<script>

var apiKey = '67efa90bc29e4925b6069f4ba9a5d926';
var sections = ['world', 'technology', 'sports']

sections.forEach( function(section) {
	var nytUrl = `https://api.nytimes.com/svc/topstories/v2/${section}.json?api-key=${apiKey}`

	// Create a header for each Section.
	var sectionHeader = document.createElement('h2');
	sectionHeader.textContent = `Section: ${section.toUpperCase()}`;

	// Add Section to the main #app
	var target = document.querySelector('#app');
	target.append(sectionHeader);

	// API call to NYT
	makeRequest(nytUrl, 'GET', function (news) {

		// News list for each Section
		var newsDiv = document.createElement('div');
		sectionHeader.after(newsDiv);

		// Top 3 news from the NYT
		for (var i=0; i<3; i++) {
			// Create title w/ link
			var title = document.createElement('h4');
			var titleLink = document.createElement('a');
			titleLink.href = news.results[i].url;
			titleLink.textContent = news.results[i].title;
			titleLink.setAttribute('target', '_blank');
			title.append(titleLink);

			// Add title to the News list
			newsDiv.append(title);

			// Add abstract after Title
			var abstract = document.createElement('p')
			abstract.textContent = news.results[i].abstract;
			title.after(abstract);
		}
	});
});

</script>
</body>
</html>